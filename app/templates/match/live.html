{% extends "base.html" %}
{% block title %}{{ match.home_team }} vs {{ match.away_team }} - Direct{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto px-4 py-8">

    <!-- Auto-refresh every 30 seconds if live -->
    {% if match.status == 'live' %}
    <meta http-equiv="refresh" content="30">
    {% endif %}

    <!-- Action Bar (Hidden in Print) -->
    <div class="flex justify-between items-center mb-6 print:hidden">
        <a href="{{ request.referrer or url_for('main.index') }}"
            class="flex items-center gap-2 text-gray-400 hover:text-white transition">
            <i class="fa-solid fa-arrow-left"></i> Retour
        </a>
        <button onclick="window.print()"
            class="btn-secondary px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2">
            <i class="fa-solid fa-file-pdf"></i> Exporter PDF
        </button>
    </div>

    <!-- Match Card (Printable) -->
    <div class="card p-8 print:border-0 print:shadow-none print:p-0 print:bg-white print:text-black">

        <!-- Header / Scoreboard -->
        <div class="flex flex-col items-center justify-center border-b border-white/10 pb-8 mb-8 print:border-black/20">
            <div class="text-xs font-bold uppercase tracking-wider text-primary-400 mb-4 print:text-black/60">{{
                match.date.strftime('%d %B %Y - %H:%M') }} | {{ match.type|default('Match') }}</div>

            <div class="flex items-center justify-between w-full max-w-2xl px-4">
                <!-- Home Team -->
                <div class="flex flex-col items-center w-1/3">
                    <div
                        class="w-20 h-20 md:w-24 md:h-24 rounded-full bg-white/5 flex items-center justify-center text-3xl mb-4 print:border print:border-black/10">
                        üè†
                    </div>
                    <h2 class="text-xl md:text-2xl font-bold text-center leading-tight">{{ match.home_team }}</h2>
                </div>

                <!-- Score -->
                <div class="flex flex-col items-center">
                    <div class="text-5xl md:text-7xl font-bold tabular-nums tracking-tighter flex items-center gap-4">
                        <span class="text-white print:text-black">{{ match.score.home }}</span>
                        <span class="text-white/20 print:text-black/20">-</span>
                        <span class="text-white print:text-black">{{ match.score.away }}</span>
                    </div>
                    <div class="mt-2 badge px-3 py-1 rounded-full text-xs font-bold uppercase 
                        {% if match.status == 'live' %}bg-red-500 text-white animate-pulse
                        {% elif match.status == 'finished' %}bg-gray-500/20 text-gray-400 print:bg-gray-200 print:text-black
                        {% else %}bg-primary-500/20 text-primary-400{% endif %}">
                        {{ match.status }}
                    </div>
                </div>

                <!-- Away Team -->
                <div class="flex flex-col items-center w-1/3">
                    <div
                        class="w-20 h-20 md:w-24 md:h-24 rounded-full bg-white/5 flex items-center justify-center text-3xl mb-4 print:border print:border-black/10">
                        ‚úàÔ∏è
                    </div>
                    <h2 class="text-xl md:text-2xl font-bold text-center leading-tight">{{ match.away_team }}</h2>
                </div>
            </div>
        </div>

        <!-- Stats & Timeline Grid -->
        <div class="grid md:grid-cols-2 gap-8 print:grid-cols-2 print:gap-4">

            <!-- Timeline (Events) -->
            <div>
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-list-ol text-primary-400 print:text-black"></i>
                    Fil du Match
                </h3>
                <div class="space-y-4 relative pl-4 border-l-2 border-white/10 print:border-black/10">
                    {% for event in match.match_events|sort(attribute='minute', reverse=True) %}
                    <div class="relative pl-4">
                        <div class="absolute -left-[21px] top-0 w-3 h-3 rounded-full 
                            {% if event.type == 'Goal' %}bg-green-500
                            {% elif event.type == 'CardRed' %}bg-red-500
                            {% elif event.type == 'CardYellow' %}bg-yellow-400
                            {% else %}bg-gray-500{% endif %} border-2 border-[#020617] print:border-white">
                        </div>
                        <div class="text-sm">
                            <span class="font-bold text-primary-400 print:text-black">{{ event.minute }}'</span>
                            <span class="font-bold ml-1">{{ event.type|replace('CardRed', 'Carton
                                Rouge')|replace('CardYellow', 'Carton Jaune')|replace('Goal', 'BUT !') }}</span>
                            <div class="text-xs text-gray-400 print:text-black/60">
                                {{ event.detail or 'Action de jeu' }}
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <p class="text-sm text-gray-500">Aucun √©v√©nement marquant.</p>
                    {% endfor %}
                </div>
            </div>

            <!-- Stats (Mockup for now as we don't have deep stats in model yet) -->
            <div>
                <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-chart-pie text-primary-400 print:text-black"></i>
                    Statistiques
                </h3>
                <div class="space-y-3">
                    <!-- Generic Stat Rows -->
                    {% for stat in ['Possession', 'Tirs Cadr√©s', 'Fautes', 'Corners'] %}
                    <div>
                        <div
                            class="flex justify-between text-xs font-bold uppercase text-gray-400 mb-1 print:text-black/60">
                            <span>{{ stat }}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="h-2 bg-white/10 w-full rounded-full overflow-hidden print:bg-black/10">
                                <div class="h-full bg-white print:bg-black w-1/2"></div>
                            </div>
                            <span class="text-xs font-mono">50%</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <!-- Referee & Info -->
                <div class="mt-8 pt-4 border-t border-white/10 print:border-black/10">
                    <div class="flex justify-between text-sm py-1">
                        <span class="text-gray-400 print:text-black/60">Arbitre</span>
                        <span class="font-medium">M. Arbitre</span>
                    </div>
                    <div class="flex justify-between text-sm py-1">
                        <span class="text-gray-400 print:text-black/60">Stade</span>
                        <span class="font-medium">{{ match.location or 'Stade Municipal' }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer Print Only -->
        <div class="hidden print:block mt-12 pt-4 border-t border-black/10 text-center text-xs text-black/40">
            Document g√©n√©r√© par FootLogic Elite le {{ now }}
        </div>

    </div>
</div>
{% endblock %}