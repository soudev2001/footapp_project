{% extends "base.html" %}
{% block title %}Effectif - FootApp{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-4 py-6">
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
        <div>
            <h1 class="text-2xl font-bold">Effectif</h1>
            <p class="text-gray-400 text-sm">{{ total_players or 18 }} joueurs enregistrés</p>
        </div>
        {% if roles.is_coach %}
        <button class="btn-primary px-4 py-2.5 rounded-xl text-sm font-bold flex items-center gap-2">
            <i class="fa-solid fa-user-plus"></i>
            Ajouter
        </button>
        {% endif %}
    </div>

    <!-- Search -->
    <div class="relative mb-6">
        <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"></i>
        <input type="text" id="searchInput" placeholder="Rechercher un joueur..." oninput="filterPlayers()"
            class="w-full input-premium rounded-xl py-3 pl-12 pr-4 text-white placeholder-gray-500 focus:outline-none">
    </div>

    <!-- Position Filter -->
    <div class="flex gap-2 mb-6 overflow-x-auto pb-2 scrollbar-hide">
        <button onclick="filterByPosition('all')"
            class="position-filter active px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap" data-position="all">
            Tous
        </button>
        <button onclick="filterByPosition('gardien')"
            class="position-filter px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap" data-position="gardien">
            <i class="fa-solid fa-person text-amber-400 mr-1"></i> Gardiens
        </button>
        <button onclick="filterByPosition('defenseur')"
            class="position-filter px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap" data-position="defenseur">
            <i class="fa-solid fa-shield text-blue-400 mr-1"></i> Défenseurs
        </button>
        <button onclick="filterByPosition('milieu')"
            class="position-filter px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap" data-position="milieu">
            <i class="fa-solid fa-arrows-turn-right text-green-400 mr-1"></i> Milieux
        </button>
        <button onclick="filterByPosition('attaquant')"
            class="position-filter px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap" data-position="attaquant">
            <i class="fa-solid fa-futbol text-red-400 mr-1"></i> Attaquants
        </button>
    </div>

    <!-- Players Grid -->
    <div class="grid md:grid-cols-2 gap-4" id="playersGrid">
        <!-- Goalkeepers -->
        <div class="player-card card p-4 flex items-center gap-4 group cursor-pointer" data-position="gardien"
            data-name="Marc Petit">
            <div class="relative">
                <div class="w-16 h-16 rounded-2xl overflow-hidden">
                    <img src="https://randomuser.me/api/portraits/men/19.jpg" class="w-full h-full object-cover">
                </div>
                <span
                    class="absolute -bottom-1 -right-1 w-7 h-7 bg-amber-500 rounded-lg flex items-center justify-center text-xs font-black shadow-lg">1</span>
            </div>
            <div class="flex-1">
                <h3 class="font-bold group-hover:text-primary-400 transition">Marc Petit</h3>
                <p class="text-sm text-amber-400">Gardien</p>
                <div class="flex gap-3 mt-1 text-xs text-gray-400">
                    <span><i class="fa-solid fa-hand mr-1"></i>12 arrêts</span>
                    <span><i class="fa-solid fa-percent mr-1"></i>78% clean</span>
                </div>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-primary-400 transition"></i>
        </div>

        <!-- Defenders -->
        <div class="player-card card p-4 flex items-center gap-4 group cursor-pointer" data-position="defenseur"
            data-name="Olivier Laurent">
            <div class="relative">
                <div class="w-16 h-16 rounded-2xl overflow-hidden">
                    <img src="https://randomuser.me/api/portraits/men/45.jpg" class="w-full h-full object-cover">
                </div>
                <span
                    class="absolute -bottom-1 -right-1 w-7 h-7 bg-blue-500 rounded-lg flex items-center justify-center text-xs font-black shadow-lg">4</span>
            </div>
            <div class="flex-1">
                <h3 class="font-bold group-hover:text-primary-400 transition">Olivier Laurent</h3>
                <p class="text-sm text-blue-400">Défenseur Central</p>
                <div class="flex gap-3 mt-1 text-xs text-gray-400">
                    <span><i class="fa-solid fa-futbol mr-1"></i>2 buts</span>
                    <span><i class="fa-solid fa-shield mr-1"></i>24 tacles</span>
                </div>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-primary-400 transition"></i>
        </div>

        <div class="player-card card p-4 flex items-center gap-4 group cursor-pointer" data-position="defenseur"
            data-name="Thomas Bernard">
            <div class="relative">
                <div class="w-16 h-16 rounded-2xl overflow-hidden">
                    <img src="https://randomuser.me/api/portraits/men/41.jpg" class="w-full h-full object-cover">
                </div>
                <span
                    class="absolute -bottom-1 -right-1 w-7 h-7 bg-blue-500 rounded-lg flex items-center justify-center text-xs font-black shadow-lg">5</span>
            </div>
            <div class="flex-1">
                <h3 class="font-bold group-hover:text-primary-400 transition">Thomas Bernard</h3>
                <p class="text-sm text-blue-400">Défenseur Central</p>
                <div class="flex gap-3 mt-1 text-xs text-gray-400">
                    <span><i class="fa-solid fa-futbol mr-1"></i>1 but</span>
                    <span><i class="fa-solid fa-shield mr-1"></i>31 tacles</span>
                </div>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-primary-400 transition"></i>
        </div>

        <!-- Midfielders -->
        <div class="player-card card p-4 flex items-center gap-4 group cursor-pointer" data-position="milieu"
            data-name="Romain Lambert">
            <div class="relative">
                <div class="w-16 h-16 rounded-2xl overflow-hidden">
                    <img src="https://randomuser.me/api/portraits/men/22.jpg" class="w-full h-full object-cover">
                </div>
                <span
                    class="absolute -bottom-1 -right-1 w-7 h-7 bg-green-500 rounded-lg flex items-center justify-center text-xs font-black shadow-lg">10</span>
            </div>
            <div class="flex-1">
                <div class="flex items-center gap-2">
                    <h3 class="font-bold group-hover:text-primary-400 transition">Romain Lambert</h3>
                    <span class="text-[10px] bg-amber-500/20 text-amber-400 px-2 py-0.5 rounded-full font-bold">C</span>
                </div>
                <p class="text-sm text-green-400">Milieu Offensif</p>
                <div class="flex gap-3 mt-1 text-xs text-gray-400">
                    <span><i class="fa-solid fa-futbol mr-1"></i>8 buts</span>
                    <span><i class="fa-solid fa-hands-helping mr-1"></i>12 passes D.</span>
                </div>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-primary-400 transition"></i>
        </div>

        <div class="player-card card p-4 flex items-center gap-4 group cursor-pointer" data-position="milieu"
            data-name="Lucas Martin">
            <div class="relative">
                <div class="w-16 h-16 rounded-2xl overflow-hidden">
                    <img src="https://randomuser.me/api/portraits/men/35.jpg" class="w-full h-full object-cover">
                </div>
                <span
                    class="absolute -bottom-1 -right-1 w-7 h-7 bg-green-500 rounded-lg flex items-center justify-center text-xs font-black shadow-lg">8</span>
            </div>
            <div class="flex-1">
                <h3 class="font-bold group-hover:text-primary-400 transition">Lucas Martin</h3>
                <p class="text-sm text-green-400">Milieu Défensif</p>
                <div class="flex gap-3 mt-1 text-xs text-gray-400">
                    <span><i class="fa-solid fa-futbol mr-1"></i>2 buts</span>
                    <span><i class="fa-solid fa-arrow-right-arrow-left mr-1"></i>89% passes</span>
                </div>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-primary-400 transition"></i>
        </div>

        <!-- Forwards -->
        <div class="player-card card p-4 flex items-center gap-4 group cursor-pointer" data-position="attaquant"
            data-name="Pierre Dubois">
            <div class="relative">
                <div class="w-16 h-16 rounded-2xl overflow-hidden">
                    <img src="https://randomuser.me/api/portraits/men/32.jpg" class="w-full h-full object-cover">
                </div>
                <span
                    class="absolute -bottom-1 -right-1 w-7 h-7 bg-red-500 rounded-lg flex items-center justify-center text-xs font-black shadow-lg">9</span>
            </div>
            <div class="flex-1">
                <div class="flex items-center gap-2">
                    <h3 class="font-bold group-hover:text-primary-400 transition">Pierre Dubois</h3>
                    <span class="text-[10px] bg-green-500/20 text-green-400 px-2 py-0.5 rounded-full font-bold">⚡
                        Top</span>
                </div>
                <p class="text-sm text-red-400">Avant-Centre</p>
                <div class="flex gap-3 mt-1 text-xs text-gray-400">
                    <span><i class="fa-solid fa-futbol mr-1"></i>18 buts</span>
                    <span><i class="fa-solid fa-hands-helping mr-1"></i>7 passes D.</span>
                </div>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-primary-400 transition"></i>
        </div>

        <div class="player-card card p-4 flex items-center gap-4 group cursor-pointer" data-position="attaquant"
            data-name="Maxime Rousseau">
            <div class="relative">
                <div class="w-16 h-16 rounded-2xl overflow-hidden">
                    <img src="https://randomuser.me/api/portraits/men/28.jpg" class="w-full h-full object-cover">
                </div>
                <span
                    class="absolute -bottom-1 -right-1 w-7 h-7 bg-red-500 rounded-lg flex items-center justify-center text-xs font-black shadow-lg">11</span>
            </div>
            <div class="flex-1">
                <h3 class="font-bold group-hover:text-primary-400 transition">Maxime Rousseau</h3>
                <p class="text-sm text-red-400">Ailier Droit</p>
                <div class="flex gap-3 mt-1 text-xs text-gray-400">
                    <span><i class="fa-solid fa-futbol mr-1"></i>6 buts</span>
                    <span><i class="fa-solid fa-bolt mr-1"></i>92 vitesse</span>
                </div>
            </div>
            <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-primary-400 transition"></i>
        </div>
    </div>

    <!-- No results message -->
    <div id="noResults" class="hidden text-center py-12">
        <i class="fa-solid fa-user-slash text-4xl text-gray-600 mb-4"></i>
        <p class="text-gray-400">Aucun joueur trouvé</p>
    </div>
</div>

<style>
    .position-filter {
        background: rgba(255, 255, 255, 0.05);
        color: #9ca3af;
        transition: all 0.2s;
    }

    .position-filter:hover {
        background: rgba(255, 255, 255, 0.1);
        color: white;
    }

    .position-filter.active {
        background: linear-gradient(135deg, #6366f1, #8b5cf6);
        color: white;
    }

    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }

    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
</style>

<script>
    function filterByPosition(position) {
        // Update active filter button
        document.querySelectorAll('.position-filter').forEach(btn => {
            btn.classList.remove('active');
            if (btn.dataset.position === position) btn.classList.add('active');
        });

        // Filter cards
        const cards = document.querySelectorAll('.player-card');
        let visibleCount = 0;

        cards.forEach(card => {
            if (position === 'all' || card.dataset.position === position) {
                card.classList.remove('hidden');
                visibleCount++;
            } else {
                card.classList.add('hidden');
            }
        });

        document.getElementById('noResults').classList.toggle('hidden', visibleCount > 0);
    }

    function filterPlayers() {
        const search = document.getElementById('searchInput').value.toLowerCase();
        const cards = document.querySelectorAll('.player-card');
        let visibleCount = 0;

        cards.forEach(card => {
            const name = card.dataset.name.toLowerCase();
            if (name.includes(search)) {
                card.classList.remove('hidden');
                visibleCount++;
            } else {
                card.classList.add('hidden');
            }
        });

        document.getElementById('noResults').classList.toggle('hidden', visibleCount > 0);
    }
</script>
{% endblock %}